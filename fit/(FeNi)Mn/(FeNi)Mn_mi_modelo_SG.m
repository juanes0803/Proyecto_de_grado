
D1=[2.438397790055249 116.69829222011367;1.7309392265193368 79.69639468690684;1.5837016574585636 64.99051233396568;1.382596685082873 69.73434535104343;1.246132596685083 61.19544592030337;1.116850828729282 58.823529411764525;1.0091160220994477 52.18216318785562;0.9049723756906078 46.015180265654465;0.8367403314917128 40.322580645161054;0.793646408839779 35.578747628083306;0.7972375690607736 36.527514231498856;0.7649171270718234 30.834914611005445;0.6787292817679558 24.19354838709654;0.47044198895027617 15.654648956356482;0.3914364640883978 14.231499051233186;0.25856353591160214 2.371916508538675;0.21906077348066294 1.8975332068307011;0.15082872928176788 1.8975332068309285;0 2.371916508538675];

D1(:,1)=D1(:,1)/10;
S=size(D1)
z = ones(S(1,1),1);


ft= fittype('(7/8)*(1+(0.65*(1-x))*(0.65*(1-x))*tanh((O11+K11.*(0.65*(1-x)))/y)+x*x*tanh((O22+K22.*x)/y)+(0.35*(1-x))*(0.35*(1-x))*tanh((O33+K33.*(0.35*(1-x)))/y)+2*x*(0.65*(1-x))*tanh((O12+K12.*x)/y)+2*x*(0.35*(1-x))*tanh((O23+K23.*x)/y)+2*(0.35*(1-x))*(0.65*(1-x))*tanh((O13+K13.*(0.65*(1-x)))/y))', ...
            'independent', {'x', 'y'},'dependent', 'z' )


[mdl, goodness] =fit(D1,z,ft,'Lower',[-inf,-inf,1,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,1],'startpoint',[0 0 0 0 0 0 0 0 0 0 0 0])
mdl.K11;
mdl.K22;
mdl.K33;
mdl.K13;
mdl.K23;
mdl.K12;
syms X Y

fimplicit((7/8)*(1+(0.65*(1-X))*(0.65*(1-X))*tanh((mdl.O11+mdl.K11.*(0.65*(1-X)))/Y)+X*X*tanh((mdl.O22+mdl.K22.*X)/Y)+(0.35*(1-X))*(0.35*(1-X))*tanh((mdl.O33+mdl.K33.*(0.35*(1-X)))/Y)+2*X*(0.65*(1-X))*tanh((mdl.O12+mdl.K12.*X)/Y)+2*X*(0.35*(1-X))*tanh((mdl.O23+mdl.K23.*X)/Y)+2*(0.35*(1-X))*(0.65*(1-X))*tanh((mdl.O13+mdl.K13.*(0.65*(1-X)))/Y)) - 1,[0 0.27 0 455],'g','LineWidth',2)
hold on
grid on
txt2 = 'F';
text(0.05,150,txt2,'FontSize',14)
txt3 = 'SG';
text(0.2,50,txt3,'FontSize',14)
txt4 = 'P';
text(0.2,200,txt4,'FontSize',14)
txt1 = 'RSG-F';
text(0.080,20,txt1,'FontSize',14)

plot(D1(:,1),D1(:,2),'ro','MarkerSize',9)
set(gca, 'FontSize', 12)
xlabel('x(%Mn)')
ylabel('Tc(K)')
legend({'Modelo','Dat. Experimentales'})