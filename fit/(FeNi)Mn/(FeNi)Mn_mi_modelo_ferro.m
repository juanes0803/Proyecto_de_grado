D1=[0.02462612863010083  479.76696115839405 ;1.60378539702414  440.1508977770102 ;2.210738783858903  419.39300883475175 ;2.600617407213517  401.0596844962788 ;3.9274114770819963  365.7975832609246 ;4.6458489619031695  348.8849971126498 ;6.742086771618698  321.7546993647829 ;7.682650533485168  311.08769449136753 ;7.968061049916079  300.9509366348068 ;8.395755865098684  285.02328769341193 ;9.106896719214642  255.5871574982055 ;10.11130599975174  229.50116303544155 ;11.243406317630107  172.57718939398018 ;12.552520090020565  106.96957758336879;12.59868531121317  61.20507741876287];
D1(:,1)=D1(:,1)/100;
S=size(D1)
z = ones(S(1,1),1);


ft= fittype('(7/8)*(1+(0.65*(1-x))*(0.65*(1-x))*tanh((O11+K11.*(0.65*(1-x)))/y)+x*x*tanh((O22+K22.*x)/y)+(0.35*(1-x))*(0.35*(1-x))*tanh((O33+K33.*(0.35*(1-x)))/y)+2*x*(0.65*(1-x))*tanh((O12+K12.*x)/y)+2*x*(0.35*(1-x))*tanh((O23+K23.*x)/y)+2*(0.35*(1-x))*(0.65*(1-x))*tanh((O13+K13.*(0.65*(1-x)))/y))', ...
            'independent', {'x', 'y'},'dependent', 'z' )    


[mdl, goodness]  = fit(D1,z,ft,'Lower',[-inf,-inf,1,-inf,-inf,-inf,-inf,-inf,-inf,-inf,-inf,1],'startpoint',[0 0 0 0 0 0 0 0 0 0 0 0])
mdl.K11;
mdl.K22;
mdl.K33;
mdl.K13;
mdl.K23;
mdl.K12;
mdl.O11;
mdl.O22;
mdl.O33;
mdl.O13;
mdl.O23;
mdl.O12;
syms X Y

fimplicit((7/8)*(1+(0.65*(1-X))*(0.65*(1-X))*tanh((mdl.O11+mdl.K11.*(0.65*(1-X)))/Y)+X*X*tanh((mdl.O22+mdl.K22.*X)/Y)+(0.35*(1-X))*(0.35*(1-X))*tanh((mdl.O33+mdl.K33.*(0.35*(1-X)))/Y)+2*X*(0.65*(1-X))*tanh((mdl.O12+mdl.K12.*X)/Y)+2*X*(0.35*(1-X))*tanh((mdl.O23+mdl.K23.*X)/Y)+2*(0.35*(1-X))*(0.65*(1-X))*tanh((mdl.O13+mdl.K13.*(0.65*(1-X)))/Y)) - 1,[0 0.2 0 500],'g','LineWidth',2)
hold on
grid on
plot(D1(:,1),D1(:,2),'ro','MarkerSize',9)
