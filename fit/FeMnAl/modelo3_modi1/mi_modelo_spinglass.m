
D5=[0.325 25;0.350 27;0.350 32;0.375 31;0.375 37;0.400 50];
D1=[0.3248438893844781 22.7390180878553;0.2998661909009812 32.55813953488365;0.3502676181980374 24.80620155038747;0.3502676181980374 28.940568475452153;0.3752453166815343 28.423772609819025;0.3752453166815343 35.14211886304906;0.39977698483496876 48.062015503875955];


S=size(D1)
z = ones(S(1,1),1);

ft = fittype('(7/8)*(1+x*x*(tanh(K1./y)*tanh(K1./y))+(1-x-0.4)*(1-x-0.4)*(tanh((1-x-0.4)*a.*K1./y)*tanh((1-x-0.4)*a.*K1./y))+2*x*(1-x-0.4)*(tanh((1-x-0.4)*r.*K1./y)*tanh((1-x-0.4)*r.*K1./y)))*(x>0.3)*(x<=0.4)', ...
            'independent', {'x', 'y'},'dependent', 'z' )

mdl = fit(D1,z,ft,'Lower',[1,0,0],'startpoint',[200 1 1])
syms X Y
fimplicit((7/8)*(1+X*X*((tanh(mdl.K1/Y)*tanh(mdl.K1/Y)))+(1-X-0.4)*(1-X-0.4)*((tanh((1-X-0.4)*mdl.a.*mdl.K1/Y)*tanh((1-X-0.4)*mdl.a.*mdl.K1./Y)))+2*(1-X-0.4)*X*((tanh((1-X-0.4)*mdl.r.*mdl.K1/Y)*tanh((1-X-0.4)*mdl.r.*mdl.K1./Y))))-1,[0.3 0.425 0 400],'b')
hold on
grid on
txt1 = 'AF';
text(0.2,100,txt1,'FontSize',14)
txt2 = 'F';
text(0.45,100,txt2,'FontSize',14)
txt3 = 'SG';
text(0.35,10,txt3,'FontSize',12)
txt4 = 'P';
text(0.35,200,txt4,'FontSize',14)
title('Diagrama de fase modelo 3, propuesta 1')

plot(D1(:,1),D1(:,2),'ro')



D=[0.200 220;0.2 210;0.225 200;0.250 180;0.275 160;0.300 60;0.3 35;0.450 170;0.425 30;0.425 80;0.450 205;0.5 340;0.325 25;0.350 27;0.350 32;0.375 31;0.375 37;0.400 50];
Teo=[0.200 211.889;0.2 211.889;0.225 202.538;0.250 185.044;0.275 158.194;0.300 63.4742;0.3 36.0836;0.450 204.872;0.425 41.1417;0.425 107.272;0.450 204.872;0.5 340.686;0.325 24.1871;0.350 28.3166;0.350 28.3166;0.375 37.8695;0.375 37.8695;0.400 49.2843];
chi=0;
for cont=1:18
    chi=chi+((D(cont,2)-Teo(cont,2))^2)/Teo(cont,2);    
end
chi